import{_ as s,c as i,o as a,a2 as e}from"./chunks/framework.4_bZ6nyl.js";const c=JSON.parse('{"title":"[SQL Server]import large sql file","description":"","frontmatter":{},"headers":[],"relativePath":"WorkSkill/import large sql file.md","filePath":"WorkSkill/import large sql file.md"}'),l={name:"WorkSkill/import large sql file.md"},t=e('<h1 id="sql-server-import-large-sql-file" tabindex="-1">[SQL Server]import large sql file <a class="header-anchor" href="#sql-server-import-large-sql-file" aria-label="Permalink to &quot;[SQL Server]import large sql file&quot;">​</a></h1><h6 id="tags-工作" tabindex="-1">tags: <code>工作</code> <a class="header-anchor" href="#tags-工作" aria-label="Permalink to &quot;tags: `工作`&quot;">​</a></h6><p>在執行少量的sql寫入時，可以直接貼到Microsoft SQL Server Management Studio執行 但若是檔案太大時，可以使用sqlcmd的方式來執行<br> 指令如下:</p><div class="language-ps vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ps</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sqlcmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">S 資料庫IP </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">U 使用者名稱 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P 使用者密碼 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d 資料庫名稱 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i .sql檔案路徑</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>執行時會跳出錯誤，需開啟QUOTED_IDENTIFIER：<br><span style="color:red;"> 訊息 1934, 層級 16, 狀態 1, 伺服器 User, 行 4<br> INSERT 失敗，因為下列 SET 選項的設定錯誤: &#39;QUOTED_IDENTIFIER&#39;。請確認與 索引檢視表及/或計算資料行上的索引及/或篩選的索引及/或查詢通知及/或 XML 資料類型方法及/或空間索引作業 一起使用的 SET 選項是否正確。 </span></p><p>example:</p><div class="language-ps vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ps</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">C:\\</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sqlcmd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">I </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">S localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">U test </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P test123 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d dbo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i C:\\sql.sql</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>另外，若資料當中有中文，sqlcmd會直接結束 sqlcmd執行必須加入 <span style="color:red;">-f 65001</span> 代表對應中文編碼 SQL當中的中文欄位前方也要加 N</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dbo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ID) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">values</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> N(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王大明&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Soo1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>最後sqlcmd執行的參數會變成這樣子<br> 若要將執行的結果匯出成txt檔，可以加上-o C:\\sql.log example:<br><span style="color:red;"> C:&gt;sqlcmd -I -S localhost -U test -P test123 -d dbo -f 65001 -i C:\\sql.sql -o C:\\sql.log </span></p>',10),n=[t];function p(h,r,k,d,E,o){return a(),i("div",null,n)}const m=s(l,[["render",p]]);export{c as __pageData,m as default};
